library(tidyverse)
library(reshape2)
library(reshape2)
library(sqldf)
install.packages(sqldf)
install.packages("sqldf")
install.packages("patchwork")
library(patchwork)
library(sqldf)
ls
draft <- read_csv("./datasets/draft.csv", header = TRUE, stringsAsFactors = FALSE)
draft <- read.csv("./datasets/draft.csv", header = TRUE, stringsAsFactors = FALSE)
dim(draft)
View(draft)
View(draft)
draft <- select(draft, -c(3,4,16:24))
draft <- draft[-c(90,131),]
glimpse(draft)
head(draft,3)
tail(draft,3)
draft$Year <- as.factor(draft$Year)
draft$Tm <- as.factor(draft$Tm)
draft$Pos <- as.factor(draft$Pos)
draft$Born <- as.factor(draft$Born)
draft$From <- as.factor(draft$From)
draft$To <- as.factor(draft$To)
mutate(draft, Born2 = ifelse(Born == "us", "USA", "World")) -> draft
draft$Born2 <- as.factor(draft$Born2)
draft[is.na(draft)] <- 0
mutate(draft, College2 = ifelse(College == 0, 0, 1)) -> draft
draft$College2 <- as.factor(draft$College2)
levels(draft$Pos)
mutate(draft, Pos2 = ifelse(Pos == "G", "Guard"))
mutate(draft, Pos2 = ifelse(Pos == "G", "Guard"))
mutate(draft, Pos2 = ifelse(Pos == "G", "Guard"))
mutate(draft, Pos2 = ifelse(Pos == "G", "Guard",))
mutate(draft, Pos2 = ifelse(Pos == "G", "Guard",))
mutate(draft, Pos2 = ifelse(Pos == "G", "Guard", ifelse(Pos == "F", "Forward", ifelse(Pos == "C", "Center", ifelse(Pos == "F-G", "Swingman", ifelse(Pos == "G-F", "Swingman", ifelse(Pos == "F-C", "Big", ifelse(Pos == "C-F", "Big", "NA")))))))) -> draft
levels(draft$Pos2)
draft$Pos2 <- as.levels(draft$Pos2)
draft$Pos2 <- as.factor(draft$Pos2)
levels(draft$Pos2)
head()
head(draft)
summary(draft)
sd(draft$G)
sd(draft$WS)
sd(dra)
sd(draft$MP)
sqldf("select min(WS), Player, Tm, Pk, Year FROM draft")
sqldf("select max(WS), Player, Tm, Pk, Year FROM draft")
sqldf("select min(G), Player, Tm, Pk, Year FROM draft")
sqldf("select max(G), Player, Tm, Pk, Year FROM draft")
sqldf("select max(MP), Player, Tm, Pk, Year FROM draft")
p1 <- ggplot(draft, aes(x = WS)) + geom_histogram(fill = "royalblue3", color = "royalblue3", bins = 8) + labs(title = "Career Win Shares Distribution of NBA First-Round Selections", subtitle = "2000-09 NBA Drafts", x = "Career Win Shares", y = "Frequency") + theme(plot.title = element_text(face = "Bold"))
print(p1)
p1 <- ggplot(draft, aes(x = WS)) + geom_histogram(fill = "royalblue3", color = "royalblue3", bins = 8) + labs(title = "Career Win Shares Distribution of NBA First-Round Selections", subtitle = "2000-09 NBA Drafts", x = "Career Win Shares", y = "Frequency") + theme(plot.title = element_text(face = "bold"))
print(p1)
sqldf("select COUNT (*) FROM draft WHERE ws > 75")
p2 <- ggplot(draft, aes(x = College2, y = WS)) + geom_boxplot(color = "orange4", fill = "orange1") + labs(title = "Career Win Shares Distribution of NBA First-Round Selections", x = "", y = "Career Win Shares", subtitle = "2000-09 Drafts") + stat_summary(fun = mean, geom = "point", shape = 20, size = 8, color = "white", fill = "white") + theme(plot.title = element_text(face = "bold")) + facet_wrap(~Born2) + scale_x_discrete(breaks = c(0,1), labels = c("No College", "College"))
print(p2)
p3 <- ggplot(draft, aes(x = Year, y = WS)) + geom_boxplot(color = "dodgerblue4", fill = "dodgerblue") + labs(title = "Year-over_Year Win Shares Distribution of NBA First-Round Selections", x = "", y = "Career Win Shares", subtitle = "2000-09 Drafts") + stat_summary(fun = mean, geom = "point", shape = 20, size = 8, color = "white", fill = "white") + theme(plot.title = element_text(face = "bold"))
print(p3)
sqldf("select max(WS) FROM draft WHERE Year = 2005")
sqldf("select max(WS), Player FROM draft WHERE Year = 2005")
draft %>% summarize(MIN = min(WS), LQ = quartile(WS, .25), UQ = quartile(WS, .75), AVG = mean(WS), M = median(WS), MAX = max(WS)) -> first_tibble
draft %>% summarize(MIN = min(WS), LQ = quantile(WS, .25), UQ = quantile(WS, .75), AVG = mean(WS), M = median(WS), MAX = max(WS)) -> first_tibble
print(first_tibble)
draft %>% group_by(Year) %>% summarize(average = mean(WS)) -> second_tibble
print(second_tibble)
draft %>% group_by(Year) %>% tally(WS >= 75) -> third_tibble
print(third_tibble)
sqldf("select Player, Pk, FROM draft WHERE WS >= 75 AND Year == 2001")
sqldf("select Player, Pk FROM draft WHERE WS >= 75 AND Year == 2001")
sqldf("select Player, Pk FROM draft WHERE WS >= 75 AND Year == 2003 ORDER BY WS DESCENDING")
sqldf("select Player, Pk FROM draft WHERE WS >= 75 AND Year == 2003 ORDER BY WS DESC")
